---
title: "QQM Mobility"
  knit: (function(input_file, encoding) {
    out_dir <- 'docs';
    rmarkdown::render(input_file,
      encoding=encoding,
      output_file=file.path(dirname(input_file), out_dir, 'index.html'))})
author: "Rowan Carew"
date: "2023-11-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
load("database_PT_final.Rda")
#NB - the data is called "database"
```

```{r}
#Load libraries
library(dplyr)
library(ggplot2)
library(naniar)
library(tidyverse)
library(janitor)
library(skimr)
library(psych)
library(ggdist)
library(car)
library(correlation)
library(scales)
```

```{r}
database <-
  database %>%
  mutate(sex_front = as.factor(sex_front),
         p_bundesland_front = as.factor(p_bundesland_front),
         p_educ_front = as.factor(p_educ_front),
         age_front = as.integer(age_front),
         m_known = as.factor(m_known),
         DRT_knowledge = as.factor(DRT_knowledge),
         p_place_inhab = as.factor(p_place_inhab),
         )

glimpse(database)
```

```{r}
database_rural <- subset(database, p_place_inhab %in% c(1,2))

database_nonrural <- subset(database, p_place_inhab %in% c(3,4,5))

```

```{r}
table(database_rural$sex_front)

database_rural_boomer_filtered <- database_rural %>%
  filter(DURATION < quantile(DURATION, 0.95))

ggplot(data = database_rural_boomer_filtered) + 
  geom_point(mapping = aes(x = age_front, y = DURATION)) +
  geom_smooth(mapping = aes(x = age_front, y = DURATION)) +
ggtitle ("Boomerism and being shit at surveys")
```
```{r}
database_rural_boomer_filtered %>%
  select(age_front, DURATION) %>%
  correlation(method = "spearman")
```

